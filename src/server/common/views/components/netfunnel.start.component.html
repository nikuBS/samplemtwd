<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link rel="shortcut icon" href="<%= CDN %>/img/common/favicon.ico" />
    <link rel="shortcut icon" href="<%= CDN %>/img/common/favicon.png" />
    <link rel="apple-touch-icon" href="<%= CDN %>/img/common/favicon.png" />
    <script src="<%= CDN %>/js/vendor.js"></script>
    <link rel="stylesheet" type="text/css" href="<%= CDN %>/css/<%= style %>" media="all" />
    <link rel="stylesheet" type="text/css" href="<%= CDN %>/css/vendor.css" media="all" />
    <% include ../components/stylesheet.component.html %>
    <script type="text/javascript" src="<%= CDN %>/js/netfunnel.js" charset="UTF-8"></script>
	<script>
      var referer = '<%- referer %>';
      var action = '<%- action %>';
      $(document).ready(function() {
        var $count = $('.container-wrap span.tod-txcolor6.nwait');
        var $time = $('.container-wrap span.tod-txcolor6.tps');
        var setData = function(ret) {
          NetFunnel.gLastData = $.extend(ret.data, {
            time_left: parseInt(ret.data.ttl, 10),
            tps: parseInt(ret.data.tps, 10)
          });
          if ( NetFunnel.gLastData.tps === 0 ) {
            NetFunnel.gLastData.tps = 1;
          }
          NetFunnel.gLastData.real_time_left = Math.round(parseInt(ret.data.nwait, 10) / NetFunnel.gLastData.tps);
          if ( NetFunnel.gLastData.real_time_left < 1 ) {
            NetFunnel.gLastData.real_time_left = 1;
          }
          if ( NetFunnel.gPrevWaitTime > -1 && NetFunnel.gLastData.real_time_left > NetFunnel.gPrevWaitTime ) {
            NetFunnel.gLastData.real_time_left = NetFunnel.gPrevWaitTime;
          }
          NetFunnel.gPrevWaitTime = NetFunnel.gLastData.real_time_left;
          if ( NetFunnel.gTotWait < 0 ) {
            NetFunnel.gTotWait = NetFunnel.gLastData.nwait;
          }
        };
        var callbackEvents = {
          continued: function(event, ret) {
            setData(ret);
            NetFunnel.countdown();
            $count.text(ret.data.nwait);
            $time.text(NetFunnel.Util.getTimeStr(NetFunnel.gLastData.real_time_left));
          },
          stop: function(event) {
            window.history.back();
          },
          success: function() {
            window.location.href = referer;
          }
        };
        NetFunnel.DefaultCallback.onContinued = function(ev, ret) {
          if ( typeof ret.next == 'string' ) {
            document.location.href = ret.next;
            return;
          }
          if ( typeof ret.next == 'function' ) {
            if ( !ret.next(ev, ret) ) {
              return;
            }
          }
          if ( ret.rtype === NetFunnel.RTYPE_CHK_ENTER || ret.rtype === NetFunnel.RTYPE_GET_TID_CHK_ENTER ) {
            if ( NetFunnel.gTimer ) {
              clearTimeout(NetFunnel.gTimer);
            }
            // popup 호출하지 않기 위해 override
            // NetFunnel.PopupSetup('continue', ret, NetFunnel.gSkinId);
          }
        };
        NetFunnel_Action({
          action_id: action
        }, callbackEvents);
      });
	</script>
</head>
<body class="bg-white"><!-- 배경이 흰색일 경우 .bg-white -->
    <div class="wrap">
        <!-- #header -->
        <div id="header" class="header-wrap home">
            <div class="h-belt"><!-- 보더라인 없을 경우 .noborder -->
                <div class="h-default">
                    <div class="h-logo">
                        <a href="/main/home" class="icon-gnb-home-T"><span class="blind">홈으로</span></a>
                    </div>
                </div>
            </div>
        </div>
        <!--// #header -->
        <!-- #contents -->
        <div id="contents" class="container-wrap">
            <div class="wrap checking_wrap mt0">
                <img src="<%= CDN %>/img/common/wait.png" alt="">
                <p class="tit tx-medium mt30 mb20">잠시만 기다리시면<br> 자동 접속됩니다.</p>
                <p class="txt mb5">고객님 앞에 <span class="tod-txcolor6 nwait">0</span> 명이 접속 중입니다.</p>
                <p class="txt">예상 대기시간 <span class="tod-txcolor6 tps">0초</span></p>
            </div>
            <div class="bt-fixed-area">
                <p class="tod-wait">다시 접속하시면 대기시간이 길어지니<br> 잠시만 기다려 주세요. </p>
            </div>
        </div>
        <!--// #contents -->
    </div>
</body>
</html>
