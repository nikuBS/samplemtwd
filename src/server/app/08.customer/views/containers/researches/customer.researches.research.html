<%#
* @file customer.researches.research.html
* @author Jiyoung Jo
* @since 2018.11.12
* id: CS_12_03
%>

<%- include('../../components/start.component.html', { pageInfo: locals.pageInfo }); %>
<body>
    <!-- #skip_navigation -->
    <div id="skipNav" class="skip_navi">
        <ul>
            <!-- Grand open 접근성 수정 -->
            <li><a href="#contents" class="fe-replace-history">본문 바로가기</a></li>
            <!--  //Grand open 접근성 수정 -->
        </ul>
    </div>
    <!--// #skip_navigation -->
    <div class="wrap" data-menuId="<%= pageInfo.menuId %>" data-research-id="<%= research.info.qstnId %>">
        <!-- #header -->
        <%- include('../../../common/views/components/header.component.html', { title: '설문조사 진행', svcInfo: svcInfo, pageInfo: locals.pageInfo }); %>
        <!--// #header -->
        <!-- #contents -->
        <div id="contents" class="container-wrap">
            <h2 class="blind">내용</h2>
            <div class="container">
                <!-- .cont-box -->
                <div class="cont-box">
                    <!-- .poll-title -->
                    <div class="poll-title mb30">
                        <span class="poll-question"><%= research.info.qstnTitleNm %></span>
                        <span class="poll-date"><%= research.info.staDtm %> <span class="blind">에서</span><span class="vt" aria-hidden="true">-</span> <%= research.info.endDtm %></span>
                        <em class="poll-condition">진행 중</em>
                    </div>
                    <!-- // .poll-title -->
                    <!-- poll-chart-box -->
                    <div class="poll-chart-box">
                        <div class="poll-chart-sbox">
                            <dl class="poll-chart-txt">
                                <dt>진행률</dt>
                                <dd>0%</dd>
                            </dl>
                            <div class="bar-chart-hoz">
                                <span class="data-bar blue2" style="width:0%"></span>
                            </div><br/>
                        </div>
                    </div>
                    <!-- // poll-chart-box -->
                    <% const END_INDEX = '99';
                        research.questions.map((question, qIdx) => { 
                        const isEssential = question.mndtAnswYn === 'Y';
                        let hasEnd = false; %>
                        <div class="poll-box <%= qIdx === 0 ? '': 'none' %>" aria-hidden="<%= qIdx !== 0 %>" data-is-essential="<%= isEssential %>" data-answer-type="<%= question.inqItmTypCd %>">
                            <div class="poll-sub-tit"><%= question.inqDtlCtt %></div>
                            <% switch (question.inqItmTypCd) { 
                                case '0': {
                                let etcIdx = -1; %>
                                <div class="widget">
                                    <div class="widget-box radio">
                                        <ul class="select-list alignment01 <%= question.inqSortMthdCd === 'T' ? 'division-two' : '' %>" role="radiogroup">
                                            <% for (let idx in question.examples) { 
                                                const exam = question.examples[idx];
                                                if (exam.isEtc) {
                                                    etcIdx = idx;
                                                }

                                                if (exam.nxtInqItmNum === END_INDEX) {
                                                    hasEnd = true;
                                                }

                                                const content = exam.isEtc ? '기타' : exam.content %>
                                                <li class="radiobox type01" role="radio" aria-checked="false"><!-- 체크 상태일 경우 .checked 클래스 추가, aria-checked="true" -->
                                                    <% if (exam.image) { %>
                                                        <div class="poll-img"><img src="<%= CDN %><%= exam.image %>" /></div>
                                                        <input type="radio" name="radio<%= qIdx %>" title="<%= content %>" aria-labelledby="aria-comp-q<%= qIdx %>-radio<%= idx %>" data-next-question="<%= exam.nxtInqItmNum %>" data-is-etc="<%= exam.isEtc %>"/><!-- 체크상태일 경우 checked="checked" -->
                                                        <div class="poll-text" id="aria-comp-q<%= qIdx %>-radio<%= idx %>"><%= content %><% if (exam.motHtml) { %><br/><%- exam.motHtml %><% } %></div>
                                                    <% } else { %>
                                                        <input type="radio" name="radio<%= qIdx %>" title="<%= content %>"  data-next-question="<%= exam.nxtInqItmNum %>"  data-is-etc="<%= exam.isEtc %>"/><!-- 체크상태일 경우 checked="checked" -->
                                                        <%= content %><% if (exam.motHtml) { %><br/><%- exam.motHtml %><% } %>
                                                    <% } %>
                                                </li>
                                            <% } %>
                                        </ul>
                                    </div>
                                </div>
                                <% if (etcIdx > 0) { %>
                                    <textarea class="poll-area mt10 mb10 fe-etc-area" data-etc-idx="<%= etcIdx %>" cols="20" rows="3" placeholder="기타항목 선택시 내용을 입력해주세요." disabled></textarea>
                                    <div class="max-byte"><em>0</em> <span>/ 최대 100byte</span></div>
                                <% } %>
                                <% if (question.motMsgHtmlCtt) { %><div class="mb20"><%- question.motMsgHtmlCtt %></div><% } %>
                                <% break;
                                }
                                case '1': {
                                let etcIdx = -1; %>
                                <div class="widget">
                                    <div class="widget-box check">
                                        <ul class="select-list alignment01 <%= question.inqSortMthdCd === 'T' ? 'division-two' : '' %>" role="group">
                                            <% for (let idx in question.examples) { 
                                                const exam = question.examples[idx];
                                                if (exam.isEtc) {
                                                    etcIdx = idx;
                                                }

                                                if (exam.nxtInqItmNum === END_INDEX) {
                                                    hasEnd = true;
                                                }

                                                const content = exam.isEtc ? '기타' : exam.content %>
                                                <li class="checkbox type01" role="checkbox" aria-checked="false"><!-- 체크 상태일 경우 .checked 클래스 추가, aria-checked="true" -->
                                                    <% if (exam.image) { %>
                                                        <div class="poll-img"><img src="<%= CDN %><%= exam.image %>" /></div>
                                                        <input type="checkbox" name="checkbox" value="" title="<%= content %>" aria-labelledby="aria-comp-q<%= qIdx%>-checkbox<%= idx %>" data-is-etc="<%= exam.isEtc %>"/><!-- 체크상태일 경우 checked="checked" -->
                                                        <div class="poll-text" id="aria-comp-q<%= qIdx%>-checkbox<%= idx %>"><%= content %><% if (exam.motHtml) { %><br/><%- exam.motHtml %><% } %></div>
                                                    <% } else { %>
                                                        <input type="checkbox" name="checkbox" value="" title="<%= content %>"  data-is-etc="<%= exam.isEtc %>"/><!-- 체크상태일 경우 checked="checked" -->
                                                        <%= content %><% if (exam.motHtml) { %><br/><%- exam.motHtml %><% } %>
                                                    <% } %>
                                                </li>
                                            <% } %>
                                        </ul>
                                    </div>
                                </div>
                                <% if (etcIdx > 0) { %>
                                    <textarea class="poll-area mt10 mb10 fe-etc-area" data-etc-idx="<%= etcIdx %>" cols="20" rows="3" placeholder="기타항목 선택시 내용을 입력해주세요." disabled></textarea>
                                    <div class="max-byte"><em>0</em> <span>/ 최대 100byte</span></div>
                                <% } %>
                                <% if (question.motMsgHtmlCtt) { %><div class="mb20"><%- question.motMsgHtmlCtt %></div><% } %>
                                <% break;
                                }
                                case '2': {%> 
                                <textarea class="poll-area mt10 mb10" cols="20" rows="3" placeholder="내용을 입력해주세요."></textarea>
                                <div class="max-byte"><em>0</em> <span>/ 최대 100byte</span></div>
                                <% break;
                                }
                            } %>
                            <% if (qIdx === 0) { %>
                                <ul class="bt-slice mt30">
                                    <% if (qIdx === research.questions.length - 1 ) { %>
                                        <li class="bt-blue1">
                                            <button class="fe-submit-research" <%= isEssential? 'disabled' : '' %>>참여하기</button>
                                        </li>
                                    <% } else { %>
                                        <li class="bt-blue1">
                                            <button class="fe-go-next" <%= isEssential? 'disabled' : '' %>>다음으로</button>
                                        </li>
                                    <% } %>
                                </ul>
                            <% } else { %>
                                <ul class="bt-slice mt30 item-two">
                                    <li class="bt-white2">
                                        <button class="fe-go-prev">이전으로</button>
                                    </li>
                                    <% if (qIdx === research.questions.length - 1) { %>
                                        <li class="bt-blue1">
                                            <button class="fe-submit-research" <%= isEssential? 'disabled' : '' %>>참여하기</button>
                                        </li>
                                    <% } else { %>
                                        <li class="bt-blue1" >
                                            <button class="fe-go-next" <%= isEssential? 'disabled' : '' %>>다음으로</button>
                                        </li>
                                    <% } %>
                                </ul>
                            <% } %>
                        </div>
                    <% }); %>
                    </div>
                </div>
                <!-- // .cont-box -->
            </div>
        </div>
        <!--// #contents -->
    
        <%- include('../../../common/views/components/footer.component.html', { svcInfo: svcInfo, pageInfo: pageInfo }); %>
    </div>
</body>

<% include ../../components/javascript.component.html %>
<script>
    $(document).ready(function () {
        new Tw.CustomerResearch($('.wrap'));
    });
</script>
<% include ../../components/end.component.html %>