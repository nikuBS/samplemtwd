<%#
* @file customer.agentsearch.detail.html (CS_02_02)
* @author Hakjoon Sim (hakjoon.sim@sk.com)
* @since 2018.10.29
%>

<%- include('../../components/start.component.html', { pageInfo: locals.pageInfo }); %>
<body>
    <!-- #skip_navigation -->
    <div id="skipNav" class="skip_navi">
        <ul>
            <li><a href="#contents-area" class="fe-replace-history">본문 바로가기</a></li>
        </ul>
    </div>
    <!--// #skip_navigation -->
    <div class="wrap">
        <%- include('../../../../common/views/components/header.component.html', { title: '매장정보', svcInfo: svcInfo }); %>
        <!-- #contents -->
        <div id="contents" class="container-wrap">
            <h2 id="contents-area" tabindex="-1"><span class="blind">본문시작</span></h2>
            <div class="container">
                <!-- cont-box -->
                <div class="cont-box">
                    <!-- .shop-info -->
                    <div class="shop-info tod-shop-info fe-shop-info">
                        <%_if(detail.shopTypeNm.length > 0){_%>
                        <!-- .shop-tag -->
                        <div class="shop-tag">
                            <%_detail.shopTypeNm.map( shopTypeNm => {_%>
                            <span class="tag"><%-shopTypeNm%></span>
                            <%_})_%>
                        </div>
                        <!-- // .shop-tag -->
                        <%_}_%>

                        <!-- .shop-nam -->
                        <div class="shop-name"><%= detail.storeName %></div>
                        <!-- // .shop-nam -->

                        <!-- .shop-map -->
                        <div class="shop-map">
                            <!-- 나의 위치 -->
                            <div class="map-pos-my" style="position: absolute; right: 16px; top: 20px;z-index: 1;">
                                <button type="button" id="fe-myLocation" class="tod-map-pos"><span class="blind">내위치</span></button>
                            </div>
                            <div id="fe-tmap-box"></div> <!--지도 부분-->
                            <button class="btn-mapfind fe-directions none"><img src="<%-CDN%>/img/ico/btn-roadfind.png" alt="길찾기"></button>
                        </div>
                        <br/>
                        <!--// .shop-map -->

                        <% if (detail.custRateCnt !== '0' && detail.custRateAvg !== '0') { %>
                        <!-- .shop-rating -->
                        <div class="shop-rating">
                            <span class="ico-star" aria-hidden="true"><span class="star-count <%= detail.star %>"><span class="blind">별점</span></span></span>
                            <!-- 별 갯수에 따라 .star1~star5로 설정(ex 평점 4.1~4.9의 소숫점 자리는 class="star4-5" 로 표현) -->
                            <span class="txt-rating">평점 <span class="grade-total"><%= detail.custRateAvg %></span> (<span class="grade-count"><%= detail.custRateCnt %></span>명)</span>
                        </div>
                        <!-- // .shop-rating -->
                        <% } %>
                        <!-- .shop-txt -->
                        <div class="shop-txt">
                            <ul>
                                <li>
                                    <dl>
                                        <dt class="blind">주소</dt>
                                        <dd>
                                            <span class="txt"><em class="blind">도로명주소</em><%= detail.searchAddr %></span>
                                            <span class="txt"><em class="blind">지번주소</em><%= detail.jibunAddr %></span>
                                        </dd>
                                    </dl>
                                </li>
                                <li>
                                    <dl>
                                        <dt class="blind">운영시간</dt>
                                        <dd>
                                            <span class="tit">평일</span>
                                            <span class="desc"><%-detail.weekTime%></span>
                                        </dd>
                                        <dd>
                                            <span class="tit">토요일/공휴일</span>
                                            <span class="desc"><%-detail.satTime%></span>
                                        </dd>
                                        <dd>
                                            <span class="tit">일요일</span>
                                            <span class="desc"><%-detail.sunTime%></span>
                                        </dd>
                                        <%# 특이사항 있을때만 노출함%>
                                        <%_ if (!!detail.businessHourEtc) { _%>
                                        <dd>
                                            <span class="tit">특이사항</span>
                                            <span class="desc"><%- detail.businessHourEtc%></span>
                                        </dd>
                                        <%_ } _%>
                                    </dl>
                                    <!-- 210119 [OP002-12833] 추가 -->
                                    <p class="mt20">대리점의 경우 각 매장마다 운영업무시간과 처리업무가 상이할 수 있습니다. 방문하시기 전에 대리점으로 확인하신 후 방문해 주시기 바랍니다.</p>
                                    <!-- //210119 [OP002-12833] 추가 -->
                                </li>
                            </ul>
                        </div>
                        <!-- // .shop-txt -->

                        <!-- .tod-o2o-btn hbs 영역-->
                    </div>
                    <!-- // .shop-info -->
                </div>
                <!-- // cont-box -->

                <!--처리업무 ~ 기타 영역-->
                <%
                    detail.services.forEach( (item, idx) => {
                    const isPossible = item.category === 'POSSIBLE_TASK';
                    const clsNm = !isPossible ? 'blue' : 'gray';
                    const addHashTag = isPossible ? '#' : '';
                %>
                <% if (idx === 0) { %>
                <hr class="cont-sp type1" aria-hidden="true">
                <% }%>

                <!-- cont-box -->
                <div class="cont-box">
                    <div class="tod-shop-texts">
                        <p class="tit"><%-item.title%></p>
                        <div class="list">
                            <%item.datas.forEach( data => {%>
                            <span class="item-txt <%-clsNm%>"><%-`${addHashTag}${data}`%></span>
                            <%});%>
                        </div>
                    </div>
                </div>
                <!-- // cont-box -->

                <hr class="cont-sp type1" aria-hidden="true">
                <!--매장 소개-->
                <%if ((detail.prPhrs && detail.prPhrs.trim().length > 0) && (isPossible || idx === 0)) {%>
                <!-- cont-box -->
                <div class="cont-box">
                    <div class="tod-shop-texts">
                        <p class="tit">매장소개</p>
                        <div class="list">
                            <!-- 200723 수정 :백엔드에서 데이터 수신시 리스트 형식이 아닌 한개의 값으로 셋팅되어 수정됨.   -->
                            <div class="ol-list">
                                <%-detail.prPhrs%>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- // cont-box -->

                <hr class="cont-sp type1" aria-hidden="true">
                <%}%>
                <!--// 매장 소개-->

                <%});%>
                <!--//처리업무 ~ 기타 영역-->

                <!--매장 이미지 ajax로 가져오는 부분-->
                <div id="fe-gallery" class="none">
                    <!-- cont-box -->
                    <div class="cont-box nogaps ">
                        <div class="tod-shop-gallery">
                            <!-- .widget -->
                            <div class="widget">
                                <div class="widget-box slider1 fe-slider-area"><!-- 자동롤링 기능 필요할 경우 data-slider-auto="true" 추가 -->
                                    <div class="slider-box">
                                        <ul class="slider fe-slider">
                                            <!--이미지 렌더링 영역-->
                                            <!--<li><span class="slide-item" ><img src="<%-CDN%>/img/dummy/dmy-o2o-1.png" alt=""></span></li>
                                            <li><span class="slide-item" ><img src="<%-CDN%>/img/dummy/dmy-o2o-2.png" alt=""></span></li>
                                            <li><span class="slide-item" ><img src="<%-CDN%>/img/dummy/dmy-o2o-3.png" alt=""></span></li>-->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!--// .widget -->
                        </div>
                    </div>
                    <!-- // cont-box -->
                    <hr class="cont-sp type1" aria-hidden="true">
                </div>
                <!--//매장 이미지 ajax로 가져오는 부분-->

                <!-- cont-box -->
                <div class="cont-box">
                    <div class="tod-shop-place">
                        <ul>
                            <li class="item"><a href="/customer/agentsearch/repair" class="link-as">A/S센터 찾기</a></li>
                            <li class="item"><a href="/customer/agentsearch/expzone5gx" class="link-5gx">5GX 체험존 찾기</a></li>
                        </ul>
                    </div>
                </div>
                <!-- // cont-box -->
            </div>
        </div>
        <!--// #contents -->
        <footer id="fe-all-menu">
            <%- include('../../../../common/views/components/footer.component.html', { svcInfo: svcInfo }); %>
            <%- include('../../../../common/views/components/masking.component.html', { svcInfo: svcInfo, pageInfo: pageInfo }); %>
        </footer>
    </div>
</body>
<% include ../../components/javascript.component.html %>
<% include ../../components/tmap.component.html %>

<script type="text/template" id="tpl_img">
    {{#list}}
        <li><span class="slide-item" ><img src="{{this}}" alt=""></span></li>
    {{/list}}
</script>
<script type="text/template" id="tpl_contact_item">
    {{#if isReserve}}
    <div class="tod-o2o-btns col2">
        <a class="btn btn-phone fe-tel" data-tel="{{tel}}">전화걸기</a>
        <a href="#" class="btn btn-booking fe-booking" data-booking-url="{{url}}" data-charge="{{charge}}">상담 예약</a>
    </div>
    {{else}}
    <div class="tod-o2o-btns col1">
        <a class="btn btn-phone fe-tel" data-tel="{{tel}}">전화걸기</a>
    </div>
    {{/if}}
</script>
<script>
  $(document).ready(function () {
    var options = {
      coord: {
        lon: '<%- detail.geoX %>',
        lat: '<%- detail.geoY %>'
      },
      svcInfo: JSON.parse('<%- JSON.stringify(svcInfo)%>'),
      detail: JSON.parse('<%- JSON.stringify(detail)%>'),
      locCode: '<%-detail.locCode%>'
    };
    new Tw.CustomerAgentsearchDetail($('.wrap'), options);
  });
</script>
<% include ../../components/end.component.html %>
