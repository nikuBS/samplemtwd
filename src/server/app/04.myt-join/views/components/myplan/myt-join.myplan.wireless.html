<%#
* 나의 가입정보 > 나의 요금제/부가상품 (무선)
* @file myt-join.myplan.wireless.html
* ID: MS_06
_%>
<%_ var feePlanProd = feePlan.product; _%>
<div class="tod-plan-compact-info-v2">
    <%_ if (feePlanProd.prodLinkYn === 'Y' && feePlanProd.linkProdId) { _%>
    <a href="/product/callplan?prod_id=<%- feePlanProd.linkProdId %>">
        <%- include('./myt-join.myplan.wireless.header-info.html', { feePlanProd }) _%>
    </a>
    <%_ } else { _%>
    <div class="none-link">
        <%- include('./myt-join.myplan.wireless.header-info.html', { feePlanProd }) _%>
    </div>
    <%_ } _%>
    <%# 옵션 변경 항목이 없는 경우, 비노출 _%>
    <%_ if (svcInfo.svcAttrCd === 'M1' && (feePlanProd.btnList && feePlanProd.btnList.length)) { _%>
    <ul class="btn-link-list" data-id="routers">
        <%_ feePlanProd.btnList.forEach(btn => { _%>
        <li class="full">
            <button data-id="bt-goto" data-href="<%= btn.btnLinkUrl %>?prod_id=<%- feePlanProd.linkProdId %>"><%= btn.btnNm %></button>
        </li>
        <%_ }); _%>
    </ul>
    <%_ } _%>
</div>
<%# 나의 혜택/할인: 모바일/PPS만 노출 _%>
<%_ if (benefits && (benefits.count > 0) && ['M1', 'M2'].includes(svcInfo.svcAttrCd)) { _%>

<hr class="cont-sp type1" aria-hidden="true">

<!-- .cont-box -->
<div class="cont-box nogaps">
    <ul class="full-link-list type02">
        <li>
            <a href="/benefit/my">
                <span class="inner">
                    <span class="tit">나의 혜택/할인</span>
                    <%# "benefit.myt-benefit.html", "benefit.myt-benefit.controller.ts"의 "count" 참고 _%>
                    <%# <span class="text tod-txt-point"><!%- benefits.count %!>건</span> _%>
                </span>
            </a>
        </li>
    </ul>
</div>
<!--// .cont-box -->
<%_ } _%>
<%# 요금제(MP) 페이지로 이동(MS_05_01): 모바일/PPS/T Pocket-Fi만 노출 _%>
<%_ if (['M1', 'M2', 'M3'].includes(svcInfo.svcAttrCd)) { _%>

<hr class="cont-sp type1" aria-hidden="true">

<!-- .cont-box -->
<div class="cont-box nogaps">
    <div class="banner-area">
        <a href="/product/mobileplan"><img src="<%= CDN %>/img/etc/banner_change_plan.png" alt="다양한 요금제 확인하고 나에게 맞는 요금제로 변경하세요 요금제 확인하기"></a>
    </div>
</div>
<!--// .cont-box -->
<%_ } _%>
<%# 알람 서비스 신청하기: 모바일/PPS만 노출 _%>
<%_ if (['M1', 'M2'].includes(svcInfo.svcAttrCd)) { _%>

<hr class="cont-sp type1" aria-hidden="true">

<!-- .cont-box -->
<div class="cont-box nogaps">
    <div class="tod-bnr-chg-alarm">
        <p class="txt">알림신청하면 요금제 변경 가능일을 알려드려요.</p>
        <a href="/myt-join/myplan/alarm" class="btn-line">알람 서비스 신청하기</a>
    </div>
</div>
<!--// .cont-box -->
<%_ } _%>
<%# 나의 부가상품 _%>
<%_
var dcPrograms = additions.dcPrograms;
var additionsPaid = additions.joined.paids;
var additionsFree = additions.joined.frees;
var showMoreButton = (dcPrograms && dcPrograms.length > 2)
    || (additionsPaid && additionsPaid.length > 2)
    || (additionsFree && additionsFree.length > 2);
_%>
<%_ if ((dcPrograms && dcPrograms.length > 0) || (additionsPaid && additionsPaid.length > 0) || (additionsFree && additionsFree.length > 0)) { _%>

<hr class="cont-sp type1" aria-hidden="true"/>

<!-- .cont-box -->
<div class="cont-box nogaps-btm">
    <h3 class="tit-type7">나의 부가상품</h3>
    <ul class="tod-full-link-list<%- showMoreButton ? ' tod-hidden-list' : null %>" data-id="addition-prods"><!-- 전체열기 : tod-hidden-list 삭제 -->
        <%_ if (dcPrograms && dcPrograms.length > 0) { _%>
        <li>
            <a href="/myt-join/additions#tod-cont1">
                <span class="inner">
                    <span class="tit">옵션/할인 프로그램</span>
                    <span class="text tod-txt-point"><%- dcPrograms.length %>건</span>
                </span>
                <ul class="inner-list">
                    <%_ for (var i = 0, j = dcPrograms.length; i < j; i += 1) { _%>
                        <%_ var program = dcPrograms[i]; _%>
                    <li><%= program.prodNm %></li>
                    <%_ } _%>
                </ul>
            </a>
        </li>
        <%_ } _%>
        <%# 모바일/PPS만 표시 _%>
        <%_ if (['M1', 'M2'].includes(svcInfo.svcAttrCd)) { _%>
            <%_ if (additionsPaid && additionsPaid.length > 0) { _%>
        <li>
            <a href="/myt-join/additions#tod-cont2">
                <span class="inner">
                    <span class="tit">유료 부가서비스</span>
                    <span class="text tod-txt-point"><%- additionsPaid.length %>건</span>
                </span>
                <ul class="inner-list">
                    <%_ for (var i = 0, j = additionsPaid.length; i < j; i += 1) { _%>
                        <%_ var paid = additionsPaid[i]; _%>
                    <li><%= paid.prodNm %></li>
                    <%_ } _%>
                </ul>
            </a>
        </li>
            <%_ } _%>
            <%_ if (additionsFree && additionsFree.length > 0) { _%>
        <li>
            <a href="/myt-join/additions#tod-cont3">
                <span class="inner">
                    <span class="tit">무료 서비스</span>
                    <span class="text tod-txt-point"><%- additionsFree.length %>건</span>
                </span>
                <ul class="inner-list">
                    <%_ for (var i = 0, j = additionsFree.length; i < j; i += 1) { _%>
                        <%_ var free = additionsFree[i]; _%>
                    <li><%= free.prodNm %></li>
                    <%_ } _%>
                </ul>
            </a>
        </li>
            <%_ } _%>
        <%_ } _%>
    </ul>
    <%_ if (showMoreButton) { _%>
    <div class="btn-more">
        <button>나의 부가상품 전체보기 <i class="ico-plus-32"></i> </button>
    </div>
    <%_ } _%>
</div>
<!--// .cont-box -->
<%_ } _%>
<%# 나의 로밍 요금제/부가서비스: 모바일만 노출 _%>
<%_ if (svcInfo.svcAttrCd === 'M1') { _%>
    <%_ const additionsRoaming = additions.roaming; _%>
    <%_ if (additionsRoaming && (additionsRoaming.recentlyJoinsProdNm || additionsRoaming.addRoamingProdCnt > 0)) { _%>

<hr class="cont-sp type1" aria-hidden="true"/>

<!-- .cont-box -->
<div class="cont-box nogaps">
    <ul class="full-link-list type02">
        <li>
            <a href="/product/roaming/my-use<%- additionsRoaming.recentlyJoinsProdNm ? null : '#add' %>">
                <span class="inner">
                    <span class="tit">나의 로밍 요금제/부가서비스</span>
                    <span class="text tod-txt-point"><%- (additionsRoaming.recentlyJoinsProdNm ? 1 : 0) + additionsRoaming.addRoamingProdCnt %>건</span>
                </span>
            </a>
        </li>
    </ul>
</div>
<!--// .cont-box -->
    <%_ } _%>
<%_ } _%>
<%# // TODO: 성능 문제로 배포 연기(요금안내서(선불폰), 약정할인, 이용/청구요금, 사용패턴은 점검 후 적용 예정) _%>
<%_ if (false) { _%>
<%_ if (svcInfo.svcAttrCd === 'M2') { _%>
<%# PPS인 경우 _%>

<hr class="cont-sp type1" aria-hidden="true"/>

<!-- .cont-box -->
<div class="cont-box nogaps-hoz">
    <ul class="tod-full-link-list">
        <%# 음성 요금제 _%>
        <%_ if (pps.type === 'B' || pps.type === 'C') { _%>
        <li>
            <a href="/myt-fare/billguide/guide">
                <p class="sub-tit">요금안내서</p>
                <span class="inner">
                    <span class="tit">카드잔액</span>
                    <span class="text tod-txt-point"><%- pps.prodAmt %>원</span>
                </span>
            </a>
        </li>
        <%_ } _%>
        <%# 데이터 요금제 _%>
        <%_ if (pps.type === 'A' || pps.type === 'C') { _%>
        <li>
            <a href="/myt-fare/billguide/guide">
                <p class="sub-tit">요금안내서</p>
                <span class="inner">
                    <span class="tit">잔여 데이터양</span>
                    <span class="text tod-txt-point"><%- pps.remained %>MB</span>
                </span>
            </a>
        </li>
        <%_ } _%>
    </ul>
</div>
<!--// .cont-box -->
<%_ } else { _%>

<hr class="cont-sp type1" aria-hidden="true"/>

<!-- .cont-box -->
<div class="cont-box nogaps-hoz">
    <ul class="tod-full-link-list">
        <%# 약정할인/기기상환정보: 모바일만 노출, 첫번째 항목 노출 _%>
        <%_ if (svcInfo.svcAttrCd === 'M1' && agreements && agreements.fees && agreements.fees.length) { _%>
            <%_ const fee = agreements.fees[0]; _%>
        <li>
            <a href="/myt-join/myplancombine/infodiscount">
                <p class="sub-tit">약정할인/기기상환정보</p>
                <span class="inner">
                    <span class="tit"><%= fee.disProdNm2 %></span>
                    <span class="text tod-txt-point"><%= fee.remDt %>일</span>
                </span>
            </a>
        </li>
        <%_ } _%>
        <%# 이번 달 청구/이용 요금 _%>
        <%_ if (usageFee.useAmtTot && usageFee.useAmtTot !== '0' || usageFee.claimPay && usageFee.claimPay !== '0') { _%>
        <li>
            <a href="/myt-fare/billguide/guide">
                <%_ if (usageFee.type === 'UF') { _%>
                <p class="sub-tit">이번 달 이용요금</p>
                <span class="inner">
                    <span class="tit"><%- usageFee.usageDate %> (통합청구 이용 중)</span>
                    <span class="text tod-txt-point"><%- usageFee.useAmtTot %>원</span>
                </span>
                <%_ } else { _%>
                <p class="sub-tit">이번 달 청구요금</p>
                <span class="inner">
                    <span class="tit"><%- usageFee.claimDate %> (통합청구 이용 중)</span>
                    <span class="text tod-txt-point"><%- usageFee.claimPay %>원</span>
                </span>
                <%_ } _%>
            </a>
        </li>
        <%_ } _%>
        <%# 최근 사용패턴(3개월): 모바일만 노출 _%>
        <%_ if (svcInfo.svcAttrCd === 'M1' && usagePattern.totalUsage) { _%>
        <li>
            <a href="/myt-data/usage-pattern">
                <p class="sub-tit">최근 사용패턴</p>
                <span class="inner">
                    <span class="tit">3개월간 <%= usagePattern.typeName %> 사용</span>
                    <span class="text tod-txt-point">평균 <%= usagePattern.displayName %></span>
                </span>
            </a>
        </li>
        <%_ } _%>
    </ul>
</div>
<!--// .cont-box -->
<%_ } _%>
<%_ } _%>
<%_ if (tipList) { _%>

<!-- .cont-box -->
<div class="cont-box noborder bgnone">
    <h3 class="pg-chk-tit">꼭 확인해 주세요</h3>
    <ul class="pg-chk-list02">
        <%_ for (var i in tipList) { _%>_%>
            <%_ var tip = tipList[i]; _%>
        <li><button id="<%- tip.code %>" class="btn-tip" aria-haspopup="true" page-id="<%- pageInfo.menuId %>"><%= tip.title %><i class="icon-badge-tip"><span class="blind">tip</span></i></button></li>
        <%_ } _%>
    </ul>
</div>
<!--// .cont-box -->
<%_ } _%>
