<%#
* 나의 가입정보 > 나의 결합상품
* @file myt-join.myplancombine.html
* @author Jiyoung Jo
* @since 2018.10.19
* ID: MS_07
_%>
<%- include('../../components/start.component.html', { pageInfo: locals.pageInfo }); _%>
<body>
    <!-- #skip_navigation -->
    <div id="skipNav" class="skip_navi">
        <ul>
            <li><a href="#contents-area" class="fe-replace-history">본문 바로가기</a></li>
        </ul>
    </div>
    <!--// #skip_navigation -->
    <div class="wrap" data-menuId="<%= pageInfo.menuId %>">
        <!-- #header -->
        <%- include('../../../common/views/components/header.component.html', { title: '나의 결합상품', svcInfo: svcInfo, pageInfo: locals.pageInfo }); _%>
        <!--// #header -->
        <!-- #contents -->
        <div id="contents" class="container-wrap">
            <h2 id="contents-area" tabindex="-1"><span class="blind">본문시작</span></h2>
            <div class="container">
                <%# OP002-8156: [개선][FE](W-1910-078-01) 회선선택 영역 확대 2차 _%>
                <%- include('../../../../../common/views/components/common.select-line.component.v2.html', { svcInfo: svcInfo, xtEid: { single: "CMMA_A3_B13_C63-1", multiple: "CMMA_A3_B13_C63-2" } }); _%>
                <%# // OP002-8156: [개선][FE](W-1910-078-01) 회선선택 영역 확대 2차 _%>
                <div class="ti-caption-gray">
                    <p class="num">총<em><%- combinations.length %></em>개</p>
                </div>
                <!-- .cont-box -->
                <%_ if (combinations.length > 0) { _%>
                    <div class="cont-box nogaps-hoz">
                        <div class="my-product-list">
                            <ul>
                                <%_
                                // OP002-8855 변경 사항 참조
                                const COMBINATION_PRODUCTS = [
                                    'TW20000012', 'NA00005055', 'TW20000009', 'NA00004211',
                                    'NH00000084', 'TW20000008', 'NH00000059','TW20000007',
                                    'NA00002040', // T끼리온가족할인제도
                                    'TW20000010', // T끼리온가족할인제도
                                    'NA00004728', 'TW20000011', 'NH00000114', 'TW20000013', 'NH00000133'
                                ];
                                const INTERNET_PRODUCTS = [
                                    'NH00000037', // T+B인터넷(개인형)
                                    'NH00000039', // T+B인터넷(패밀리형)
                                    'TW00000062', // T+B인터넷
                                    'NH00000040', // 개인형 T+B전화/인터넷전화(개인형)
                                    'NH00000041', // T+B전화/인터넷전화(패밀리형)
                                    'TW00000063' // T+B전화/인터넷전화
                                    // 'NH00000050', // T+B전화(정액형)
                                    // 'NH00000051' // T+B전화(실속형)
                                ];
                                const TIPS = {
                                    NA00005055: '02',
                                    TW20000012: '02',
                                    NA00002040: '03', // T끼리온가족할인제도
                                    TW20000010: '03', // T끼리온가족할인제도
                                    NA00004728: '04',
                                    TW20000011: '04',
                                    TW20000009: '05',
                                    NA00004211: '05',
                                    NH00000084: '06',
                                    TW20000008: '06',
                                    NH00000039: '07', // T+B인터넷(패밀리형)
                                    TW00000062: '07', // T+B인터넷
                                    NH00000059: '08',
                                    TW20000007: '08',
                                    NH00000103: '09',
                                    TW00000009: '09',
                                    NH00000037: '10', // T+B인터넷(개인형)
                                    NH00000041: '10', // T+B전화/인터넷전화(패밀리형)
                                    NH00000105: '11',
                                    TW00000016: '11',
                                    NH00000040: '12', // T+B전화/인터넷전화(개인형)
                                    TW00000063: '12' // T+B전화/인터넷전화
                                };
                                let showFamilyTyped;
                                combinations.forEach(comb => {
                                    const prodType = comb.prodNm.includes('개인') && 1 || comb.prodNm.includes('패밀리') && 2 || 0;
                                    // FIXME: 조건이 이상함
                                    // TW00000062: T+B인터넷(개인형)
                                    // NH00000039: 패밀리지만, 문구는 이렇게? T+B인터넷(개인형) <= 구문이 이상해 보임 확인 필요
                                    const tip = prodType === 1 && (comb.prodId === 'TW00000062' || comb.prodId === 'NH00000039') ?
                                        'MS_07_tip_10' :
                                    // TODO: 아래처럼 되어야 할 것으로 보임
                                    // TW00000062: T+B인터넷(개인형)
                                    // NH00000037: T+B인터넷(개인형)
                                    // tip = (comb.prodId === 'TW00000062' && prodType === 1) || comb.prodId === 'NH00000037' ?
                                        // 'MS_07_tip_10' :
                                    // TW00000063: T+B전화/인터넷전화(패밀리형)
                                    // NH00000041: T+B전화/인터넷전화(패밀리형)
                                        (
                                            (comb.prodId === 'TW00000063' && prodType === 2) || comb.prodId === 'NH00000041' ?
                                                'TC000109' :
                                                (TIPS[comb.prodId] && `MS_07_tip_${TIPS[comb.prodId]}`)
                                        );
                                    showFamilyTyped = prodType === 2 && comb.hasIndiProd;
                                _%>
                                <%_ if (showFamilyTyped) { _%><li class="tod-add-family"><%_ } else { _%><li><%_ } _%>
                                    <div class="inner">
                                        <%_ if (showFamilyTyped) { _%><div class="tag"><span class="t-icon">자동 가입 상품</span></div><%_ } _%>
                                        <strong class="tit"><%= comb.prodNm %><%_ if (tip) { _%><button id="<%- tip %>" type="button" class="tip-view" title="<%= comb.prodNm %> TIP보기" aria-haspopup="true"><%= comb.prodNm %> TIP</button><%_ } _%></strong>
                                        <p class="txt"><%= comb.prodSmryDesc %></p>
                                        <p class="date">신청일 <%= comb.scrbDt %></p>
                                        <%_ if (COMBINATION_PRODUCTS.includes(comb.prodId)) { _%>
                                        <a class="bt-link-tx underline" href="combinations/<%- comb.prodId %>">결합가족 보기</a>
                                        <%_ } else if (INTERNET_PRODUCTS.includes(comb.prodId)) { _%>
                                        <a class="bt-link-tx underline" href="combinations/<%- comb.prodId %>?type=<%- prodType %>">결합상품 보기</a>
                                        <%_ } _%>
                                        <%_ if (comb.prodLinkYn === "Y") { _%>
                                        <a class="bt-link-tx underline" href="/product/callplan?prod_id=<%- comb.prodId %>">상품정보 보기</a>
                                        <%_ } _%>
                                        <span class="visual-area"><img src="<%= comb.prodIconImgUrl %>" alt=""></span>
                                    </div>
                                </li>
                                <%_ }); _%>
                            </ul>
                        </div>
                    </div>
                <%_ } else { _%>
                    <div class="cont-box nogaps-top">
                        <div class="contents-empty">
                            <span class="ico type1"><span class="blind"></span></span>
                            <p class="desc">현재 이용 중인<br>결합상품이 없습니다.</p>
                        </div>
                        <ul class="bt-slice">
                            <li>
                                <button class="btn-round1 btn-style1" onclick="new Tw.HistoryService().goLoad('/benefit/submain/combinations')">결합할인 보러가기</button>
                            </li>
                        </ul>
                    </div>
                <%_ } _%>
                <!--// .cont-box -->

                <!-- .cont-box -->
                <div class="cont-box noborder bgnone">
                    <h3 class="pg-chk-tit">꼭 확인해 주세요</h3>
                    <ul class="pg-chk-list02">
                        <li><button id="MS_07_tip_01" class="btn-tip" aria-haspopup="true">결합상품 변경/해지 문의<i class="icon-badge-tip"><span class="blind">tip</span></i></button></li>
                    </ul>
                </div>
                <!--// .cont-box -->
                <!--// 2018-11-02 수정 -->
            </div>
            <div class="dim" data-id="line-dim" style="display: none;"></div>
        </div>
        <!--// #contents -->
        <%- include('../../../common/views/components/footer.component.html', { svcInfo: svcInfo, pageInfo: pageInfo }); _%>
    </div>
    <%- include('../../components/javascript.component.html') _%>
    <script>
        $(document).ready(function () {
            new Tw.MyTJoinMyPlanCombine({
                $element: $('#contents')
            });
        });
    </script>
</body>
<%- include('../../components/end.component.html') _%>
