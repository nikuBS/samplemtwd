<%#
* MenuName: 나의 요금 > 서브메인 (최근 청구(이용) 영역)
* @file myt-fare.submain.recent-bill.html
* @author 양정규
* @since 2020.12.24
%>
<%_
    if (data.latestDates.length > 0) {
    const isRep = data.type !== 'UF';
    const claimTxt = isRep ? '청구' : '이용';
_%>
<section class="cont-card fe-recent-bill none">
    <div class="section-inner">
        <div class="head-tit">
            <%- `최근 ${claimTxt} 요금 내역`%>
            <button title="최근 요금 내역" type="button" class="tip" page-id="<%- data.pageInfo.menuId %>"
                    id="<%- !isRep ? 'TC000025':'TC000024' %>"
                    data-make-eid="recentBillTip">
                TIP
            </button>
        </div>
        <div class="card-cont fe-contents">
            <div class="data-belt">
                <ul class="data-ul fe-chart-list">
                    <%# fe-chart-templ 청구(이용)내역 차트 템플릿 들어가는곳%>
                </ul>
                <svg id="svg-chart" viewbox="0 0 303 140">
                    <path class="chart-dash" d="M0,0 0,0 0,0" ></path>
                    <path class="chart-area" d="M0 0 L0 0 L0 0 L0 0 L0 0 Z"></path>
                </svg>
            </div>
            <%# fe-legend-templ 하단 범례(평균 요금) 템플릿 들어가는곳%>
        </div>
    </div>
</section>

<%# 청구(이용)내역 차트 템플릿%>
<script id="fe-chart-templ" type="text/x-handlebars-template">
    {{#list}}
        <li class="month-item">
            <dl>
                <dt data-url="/myt-fare/billguide/guide?date={{date}}" data-make-eid="recentBill{{@index}}">{{month}}</dt>
                <dd>
                    <span class="tod-blind">청구</span>
                    <span class="v" style="bottom:{{claimH}}%;">{{claim}}원</span>
                    <span class="bar" style="height:{{claimH}}%;"></span>
                    <%_if(isRep){_%>
                    <span class="tod-blind">할인</span>
                    <span class="tod-blind">{{discount}}원</span>
                    <span class="discount-point" style="bottom:0%;display: none;"></span>
                    <%_}_%>
                </dd>
            </dl>
        </li>
    {{/list}}
</script>

<%# 하단 범례(평균 요금) 템플릿%>
<script id="fe-legend-templ" type="text/x-handlebars-template">
    <div class="chart-legend">
        <ul class="legend-list">
            <li class="item claim">평균 <%-claimTxt%> 요금 : <em>{{claimAvg}}원</em></li>
            <%_if(isRep){_%>
            <li class="item discount">평균 할인 요금 : <em>{{dcAvg}}원</em></li>
            <%_}_%>
        </ul>
    </div>
</script>

<script>
  $(document).ready(function () {
    var data = '<%- escape(JSON.stringify(data))%>';
    data = JSON.parse(window.unescape(data))
    new Tw.MyTFareSubMainRecentBill({
      $element: $('.fe-recent-bill'),
      data: data
    });
  });
</script>
<%_}_%>
